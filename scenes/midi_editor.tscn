[gd_scene load_steps=12 format=3 uid="uid://dfg5gn03nngaw"]

[ext_resource type="Script" uid="uid://bw22mciltt717" path="res://scripts/midi_editor.gd" id="1_fmcpj"]
[ext_resource type="Script" uid="uid://cqtp1uih7s1e6" path="res://scripts/timeline_canvas.gd" id="2_hutrh"]
[ext_resource type="Script" uid="uid://ceai2w8vydhp4" path="res://scripts/circular_preview.gd" id="3_3hibk"]
[ext_resource type="Shader" uid="uid://sbjc05vr6pco" path="res://resources/shader.gdshader" id="4_gc6mo"]
[ext_resource type="Script" uid="uid://cmm027nffeyrg" path="res://scripts/rich_text_label.gd" id="4_hdkmi"]
[ext_resource type="Script" uid="uid://cot1dggprffr4" path="res://scripts/intropanel.gd" id="5_wbltj"]
[ext_resource type="Shader" uid="uid://da8dn48bjkg8m" path="res://resources/blur.gdshader" id="6_hdkmi"]
[ext_resource type="Script" uid="uid://bu8syey15p0mj" path="res://scripts/fx_settings_panel.gd" id="7_c0ied"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_h4lnn"]
shader = ExtResource("4_gc6mo")
shader_parameter/enable_bloom = false
shader_parameter/bloom_intensity = 0.7
shader_parameter/bloom_threshold = 0.8
shader_parameter/bloom_spread = 15.0
shader_parameter/enable_crt = false
shader_parameter/crt_curvature = 6.0
shader_parameter/scanline_intensity = 0.3
shader_parameter/scanline_count = 400.0
shader_parameter/vignette_intensity = 0.4
shader_parameter/chromatic_aberration = 0.002
shader_parameter/enable_vhs = false
shader_parameter/vhs_distortion = 0.3
shader_parameter/vhs_noise = 0.15
shader_parameter/vhs_line_speed = 2.0
shader_parameter/enable_color_grading = false
shader_parameter/color_tint = Color(1, 0.6, 0.9, 1)
shader_parameter/color_saturation = 1.5
shader_parameter/color_contrast = 1.2
shader_parameter/enable_posterize = false
shader_parameter/color_steps = 16.0
shader_parameter/enable_pixelate = false
shader_parameter/pixel_size = 2.0
shader_parameter/enable_grain = false
shader_parameter/grain_intensity = 0.15
shader_parameter/enable_glitch = false
shader_parameter/glitch_intensity = 0.3
shader_parameter/enable_hue_shift = false
shader_parameter/hue_shift_speed = 0.5
shader_parameter/time = 0.0

[sub_resource type="ShaderMaterial" id="ShaderMaterial_c0ied"]
shader = ExtResource("6_hdkmi")
shader_parameter/lod = 2.70000012825

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_c0ied"]
bg_color = Color(0.25882354, 0.25882354, 0.25882354, 0.9019608)
corner_radius_top_left = 3
corner_radius_top_right = 3
corner_radius_bottom_right = 3
corner_radius_bottom_left = 3
corner_detail = 5
expand_margin_left = 5.0
expand_margin_top = 5.0
expand_margin_right = 5.0
expand_margin_bottom = 5.0

[node name="MidiEditor" type="Control" node_paths=PackedStringArray("fx_settings_panel", "fx_color_rect")]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("1_fmcpj")
fx_settings_panel = NodePath("fx_panel/fx_panel_setup")
fx_color_rect = NodePath("CanvasLayer/ColorRect3")

[node name="ColorRect" type="ColorRect" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0.043039158, 0.04303915, 0.04303915, 1)

[node name="ColorRect2" type="ColorRect" parent="."]
custom_minimum_size = Vector2(0, 73.44)
layout_mode = 1
anchors_preset = 10
anchor_right = 1.0
grow_horizontal = 2
color = Color(0.24477637, 0.2447764, 0.24477637, 1)

[node name="HSplit" type="HSplitContainer" parent="."]
clip_children = 1
clip_contents = true
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_constants/minimum_grab_thickness = 2
split_offset = 555
touch_dragger_enabled = true

[node name="Control" type="Control" parent="HSplit"]
custom_minimum_size = Vector2(0, 570.86)
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
mouse_filter = 1

[node name="TimelinePanel" type="VBoxContainer" parent="HSplit/Control"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_top = 78.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 3

[node name="ScrollContainer" type="ScrollContainer" parent="HSplit/Control/TimelinePanel"]
layout_mode = 2
size_flags_vertical = 3

[node name="TimelineCanvas" type="Control" parent="HSplit/Control/TimelinePanel/ScrollContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
script = ExtResource("2_hutrh")

[node name="VBoxContainer" type="VBoxContainer" parent="HSplit/Control/TimelinePanel/ScrollContainer/TimelineCanvas"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="AudioPlayer" type="AudioStreamPlayer" parent="HSplit/Control/TimelinePanel"]

[node name="Panel" type="Control" parent="HSplit"]
layout_mode = 2
size_flags_horizontal = 2
mouse_filter = 2

[node name="SubViewportContainer" type="SubViewportContainer" parent="HSplit/Panel"]
clip_contents = true
layout_mode = 1
anchors_preset = 4
anchor_top = 0.5
anchor_bottom = 0.5
offset_top = -256.0
offset_right = 512.0
offset_bottom = 256.0
grow_vertical = 2

[node name="SubViewport" type="SubViewport" parent="HSplit/Panel/SubViewportContainer"]
transparent_bg = true
handle_input_locally = false
size = Vector2i(720, 512)
render_target_update_mode = 4

[node name="ColorRect" type="ColorRect" parent="HSplit/Panel/SubViewportContainer/SubViewport"]
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 4
size_flags_vertical = 4
color = Color(0.043039158, 0.04303915, 0.04303915, 1)

[node name="HBoxContainer" type="HBoxContainer" parent="HSplit/Panel/SubViewportContainer/SubViewport"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 3
size_flags_vertical = 3

[node name="CircularPreview" type="Control" parent="HSplit/Panel/SubViewportContainer/SubViewport/HBoxContainer"]
custom_minimum_size = Vector2(128, 0)
layout_mode = 2
size_flags_horizontal = 10
size_flags_vertical = 4
script = ExtResource("3_3hibk")

[node name="gap3" type="Control" parent="HSplit/Panel/SubViewportContainer/SubViewport/HBoxContainer"]
custom_minimum_size = Vector2(125.575, 0)
layout_mode = 2

[node name="RichTextLabel" type="RichTextLabel" parent="HSplit/Panel/SubViewportContainer/SubViewport/HBoxContainer"]
custom_minimum_size = Vector2(325, 0)
layout_mode = 2
size_flags_horizontal = 3
bbcode_enabled = true
text = "
[center][b]Control Guide[/b][/center]

[b]Mouse Controls[/b]
â€¢ [b]Left Click[/b] - Select/place notes
â€¢ [b]Ctrl + Click[/b] - Toggle note in selection
â€¢ [b]Right Click[/b] - Note context menu
â€¢ [b]Middle Click[/b] - Seek playback to position
â€¢ [b]Shift + Drag[/b] - Box select notes
â€¢ [b]Ctrl + Scroll[/b] - Zoom in/out

[b]Editing[/b]
â€¢ [b]Ctrl+C[/b] - Copy selected notes
â€¢ [b]Ctrl+V[/b] - Paste at mouse position
â€¢ [b]Ctrl+D[/b] - Duplicate to end of selection
â€¢ [b]Ctrl+A[/b] - Select all notes
â€¢ [b]Delete/Backspace[/b] - Delete selected notes
â€¢ [b]Escape[/b] - Clear selection
â€¢ [b]Ctrl+Z[/b] - Undo
â€¢ [b]Ctrl+Y[/b] or [b]Ctrl+Shift+Z[/b] - Redo

[b]Navigation & Movement[/b]
â€¢ [b]Arrow Keys[/b] - Nudge by grid division/lane
â€¢ [b]Shift + Arrows[/b] - Mirror edge notes on clock
â€¢ [b], (Comma)[/b] - Jump to previous section
â€¢ [b]. (Period)[/b] - Jump to next section

[b]Tools[/b]
â€¢ [b]Q[/b] - Coarser snap division
â€¢ [b]E[/b] - Finer snap division
â€¢ [b]Space[/b] - Play/Pause

[b]Quick Velocity[/b] (Hover edge note)
â€¢ [b]Z[/b] - Swipe Left
â€¢ [b]X[/b] - Swipe Right
â€¢ [b]C[/b] - Cross
â€¢ [b]V[/b] - Target
â€¢ [b]B[/b] - Soft
â€¢ [b]N[/b] - Bar

[b]Documentation & Resources[/b]
â€¢ [url=https://steamcommunity.com/sharedfiles/filedetails/?id=3593093470]Tunnel/Orn Velocity Guide[/url]

â€¢ [url=https://dreamware.notion.site/HYPERBEAT-Mapping-Documentation-277bcbf066c98017b78decd4ef9bcd6c]Mapping Documentation[/url]

â€¢ [url=https://dreamware.notion.site/HYPERBEAT-Mod-Creator-Tester-Documentation-288bcbf066c980eca1d1da2a2772938f]Modding Documentation[/url]"
script = ExtResource("4_hdkmi")

[node name="ToolBar" type="HBoxContainer" parent="."]
custom_minimum_size = Vector2(0, 36.72)
layout_mode = 1
anchors_preset = 10
anchor_right = 1.0
offset_bottom = 31.0
grow_horizontal = 2

[node name="FileMenu" type="MenuButton" parent="ToolBar"]
layout_mode = 2
text = "File â–¼"

[node name="Panel" type="Panel" parent="ToolBar/FileMenu"]
show_behind_parent = true
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="gap4" type="Control" parent="ToolBar"]
custom_minimum_size = Vector2(30.91, 0)
layout_mode = 2

[node name="Label" type="Label" parent="ToolBar"]
layout_mode = 2
text = "BPM"

[node name="BPMSpinBox" type="SpinBox" parent="ToolBar"]
layout_mode = 2
min_value = 20.0
max_value = 240.0
step = 0.1
value = 120.0
select_all_on_focus = true

[node name="gap3" type="Control" parent="ToolBar"]
custom_minimum_size = Vector2(19.065, 0)
layout_mode = 2

[node name="Label2" type="Label" parent="ToolBar"]
layout_mode = 2
text = "â™ª"

[node name="DivisionSelector" type="OptionButton" parent="ToolBar"]
layout_mode = 2

[node name="gap2" type="Control" parent="ToolBar"]
custom_minimum_size = Vector2(13.705, 0)
layout_mode = 2

[node name="Label3" type="Label" parent="ToolBar"]
layout_mode = 2
text = "ðŸ”Š"

[node name="buttons" type="HBoxContainer" parent="ToolBar"]
layout_mode = 2
size_flags_horizontal = 3

[node name="play" type="Button" parent="ToolBar/buttons"]
layout_mode = 2
text = "â–¶"

[node name="pause" type="Button" parent="ToolBar/buttons"]
layout_mode = 2
text = "â”ƒâ”ƒ"

[node name="Control" type="Control" parent="."]
layout_mode = 1
anchors_preset = 10
anchor_right = 1.0
grow_horizontal = 2

[node name="ToolBar2" type="HBoxContainer" parent="Control"]
custom_minimum_size = Vector2(0, 36.72)
layout_mode = 1
anchors_preset = 14
anchor_top = 0.5
anchor_right = 1.0
anchor_bottom = 0.5
offset_top = 36.72
offset_bottom = 73.44
grow_horizontal = 2
grow_vertical = 2

[node name="PopupMenu" type="PopupMenu" parent="."]
oversampling_override = 1.0

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="BackBufferCopy" type="BackBufferCopy" parent="CanvasLayer"]
copy_mode = 2

[node name="ColorRect3" type="ColorRect" parent="CanvasLayer"]
material = SubResource("ShaderMaterial_h4lnn")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="intropanel" type="Control" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("5_wbltj")

[node name="ColorRect" type="ColorRect" parent="intropanel"]
material = SubResource("ShaderMaterial_c0ied")
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="PanelContainer" type="PanelContainer" parent="intropanel"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -20.0
offset_top = -20.0
offset_right = 20.0
offset_bottom = 20.0
grow_horizontal = 2
grow_vertical = 2

[node name="VBoxContainer" type="VBoxContainer" parent="intropanel/PanelContainer"]
layout_mode = 2

[node name="Label" type="Label" parent="intropanel/PanelContainer/VBoxContainer"]
layout_mode = 2
text = "Welcome to sooths simple midi editor!

Loaded song files must be wav or ogg, and if the song doesn't
start on beat, you can use the audio offset feature
and it will be reflected in the midi on export                             

Direct any issues or suggestions to @soothsayer on discord
"
horizontal_alignment = 1

[node name="HBoxContainer" type="HBoxContainer" parent="intropanel/PanelContainer/VBoxContainer"]
layout_mode = 2
alignment = 1

[node name="CheckBox" type="CheckBox" parent="intropanel/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
text = "<- Don't Show Again"

[node name="Label" type="Label" parent="intropanel/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2

[node name="Button" type="Button" parent="intropanel/PanelContainer/VBoxContainer/HBoxContainer"]
layout_mode = 2
text = "Continue"

[node name="fx_panel" type="Control" parent="."]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="fx_panel_setup" type="Control" parent="fx_panel"]
custom_minimum_size = Vector2(512, 512)
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("7_c0ied")

[node name="Panel" type="Panel" parent="fx_panel/fx_panel_setup"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_styles/panel = SubResource("StyleBoxFlat_c0ied")

[connection signal="meta_clicked" from="HSplit/Panel/SubViewportContainer/SubViewport/HBoxContainer/RichTextLabel" to="HSplit/Panel/SubViewportContainer/SubViewport/HBoxContainer/RichTextLabel" method="_on_meta_clicked"]
[connection signal="pressed" from="intropanel/PanelContainer/VBoxContainer/HBoxContainer/Button" to="intropanel" method="_on_button_pressed"]
